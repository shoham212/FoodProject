<!DOCTYPE html>
<html>
  <%- include('../partials/head') %>
  <link rel="stylesheet" href="/assets/css/main.css"> <!-- עדכן את הנתיב לפי המיקום האמיתי של הקובץ -->
  <link rel="stylesheet" href="/assets/css/history.css"> <!-- עדכן את הנתיב לפי המיקום האמיתי של הקובץ -->


  <article id="main">
    <header id="header" class="alt">
      <h1><a href="/">GlucoseMonitor</a></h1>
    </header>  
    <header>
      <h2>Meals History</h2>
      <p class="white-text">Select filters to view your meal history:</p>
    </header>

    <section class="wrapper style5">
      <div class="inner">

        <!-- Filter Form -->
        <form id="filterForm" action="/history" method="GET" style="margin-bottom: 20px;">
          <label for="mealType">Meal Type:</label>
          <select name="mealType" id="mealType">
            <option value="">All</option>
            <option value="breakfast">Breakfast</option>
            <option value="lunch">Lunch</option>
            <option value="dinner">Dinner</option>
          </select>

          <label for="startDate">Start Date:</label>
          <input type="date" id="startDate" name="startDate">

          <label for="endDate">End Date:</label>
          <input type="date" id="endDate" name="endDate">

          <button type="submit" class="button primary">Filter</button>
        </form>

        <!-- Meals Table -->
        <% if (mealsData && mealsData.length > 0) { %>
          <table border="1" style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead>
              <tr>
                <th>Date</th>
                <th>Meal Type</th>
                <th>Description</th>
                <th>Glucose Level</th>
              </tr>
            </thead>
            <tbody>
              <% mealsData.forEach(meal => { %>
                <tr>
                  <td><%= new Date(meal.meal_date).toLocaleDateString() %></td>
                  <td><%= meal.meal_type %></td>
                  <td><%= meal.description %></td>
                  <td><%= meal.glucose_after_meal %></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        <% } else { %>
          <p>No meals found for the selected filters.</p>
        <% } %>

      </div>
    </section>
  </article>
</html>
